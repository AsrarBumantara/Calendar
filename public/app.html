<!doctype html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pengelolaan Jadwal</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  </head>
  <body>
    <div id="root"></div>

    <script type="text/babel">
      const { useState, useEffect } = React;

      // IndexedDB configuration
      const DB_NAME = 'ScheduleDB';
      const DB_VERSION = 1;
      const STORE_NAME = 'events';

      function openDB() {
        return new Promise((resolve, reject) => {
          const request = indexedDB.open(DB_NAME, DB_VERSION);
          request.onerror = () => reject(request.error);
          request.onsuccess = () => resolve(request.result);
          request.onupgradeneeded = (event) => {
            const db = event.target.result;
            if (!db.objectStoreNames.contains(STORE_NAME)) {
              db.createObjectStore(STORE_NAME, { keyPath: 'id' });
            }
          };
        });
      }

      function saveEventToDB(event) {
        return openDB().then(db => {
          return new Promise((resolve, reject) => {
            const transaction = db.transaction([STORE_NAME], 'readwrite');
            const store = transaction.objectStore(STORE_NAME);
            const request = store.put(event);
            request.onsuccess = () => resolve(request.result);
            request.onerror = () => reject(request.error);
          });
        });
      }

      function getAllEventsFromDB() {
        return openDB().then(db => {
          return new Promise((resolve, reject) => {
            const transaction = db.transaction([STORE_NAME], 'readonly');
            const store = transaction.objectStore(STORE_NAME);
            const request = store.getAll();
            request.onsuccess = () => resolve(request.result);
            request.onerror = () => reject(request.error);
          });
        });
      }

      function deleteEventFromDB(id) {
        return openDB().then(db => {
          return new Promise((resolve, reject) => {
            const transaction = db.transaction([STORE_NAME], 'readwrite');
            const store = transaction.objectStore(STORE_NAME);
            const request = store.delete(id);
            request.onsuccess = () => resolve();
            request.onerror = () => reject(request.error);
          });
        });
      }

      function clearAllEventsFromDB() {
        return openDB().then(db => {
          return new Promise((resolve, reject) => {
            const transaction = db.transaction([STORE_NAME], 'readwrite');
            const store = transaction.objectStore(STORE_NAME);
            const request = store.clear();
            request.onsuccess = () => resolve();
            request.onerror = () => reject(request.error);
          });
        });
      }

      // Utility functions
      function formatDate(date) {
        const d = new Date(date);
        const year = d.getFullYear();
        const month = String(d.getMonth() + 1).padStart(2, '0');
        const day = String(d.getDate()).padStart(2, '0');
        const hours = String(d.getHours()).padStart(2, '0');
        const minutes = String(d.getMinutes()).padStart(2, '0');
        return `${year}-${month}-${day}T${hours}:${minutes}`;
      }

      function formatDisplayDate(date) {
        const d = new Date(date);
        const options = { 
          year: 'numeric', 
          month: 'long', 
          day: 'numeric',
          hour: '2-digit',
          minute: '2-digit'
        };
        return d.toLocaleDateString('id-ID', options);
      }

      function formatTime(date) {
        const d = new Date(date);
        return `${String(d.getHours()).padStart(2, '0')}:${String(d.getMinutes()).padStart(2, '0')}`;
      }

      function getWeeksInMonth(year, month) {
        const firstDay = new Date(year, month, 1);
        const lastDay = new Date(year, month + 1, 0);
        
        const weeks = [];
        let currentWeek = [];
        
        // Fill start of first week with previous month days
        const firstDayOfWeek = firstDay.getDay();
        for (let i = 0; i < firstDayOfWeek; i++) {
          const prevDate = new Date(year, month, 1 - (firstDayOfWeek - i));
          currentWeek.push({ date: prevDate, isCurrentMonth: false });
        }
        
        // Fill all days of current month
        for (let day = 1; day <= lastDay.getDate(); day++) {
          const date = new Date(year, month, day);
          currentWeek.push({ date, isCurrentMonth: true });
          
          if (currentWeek.length === 7) {
            weeks.push(currentWeek);
            currentWeek = [];
          }
        }
        
        // Fill end of last week with next month days
        if (currentWeek.length > 0) {
          const remaining = 7 - currentWeek.length;
          for (let i = 1; i <= remaining; i++) {
            const nextDate = new Date(year, month + 1, i);
            currentWeek.push({ date: nextDate, isCurrentMonth: false });
          }
          weeks.push(currentWeek);
        }
        
        return weeks;
      }

      function showSuccessMessage(message) {
        const toast = document.createElement('div');
        toast.textContent = message;
        toast.style.cssText = `
          position: fixed;
          top: 20px;
          right: 20px;
          background: #10b981;
          color: white;
          padding: 16px 24px;
          border-radius: 8px;
          box-shadow: 0 4px 12px rgba(0,0,0,0.15);
          z-index: 9999;
          animation: slideIn 0.3s ease;
        `;
        document.body.appendChild(toast);
        
        setTimeout(() => {
          toast.style.animation = 'slideOut 0.3s ease';
          setTimeout(() => document.body.removeChild(toast), 300);
        }, 3000);
      }

      function requestNotificationPermission() {
        if ('Notification' in window && Notification.permission === 'default') {
          Notification.requestPermission();
        }
      }

      // Main component
      function ScheduleManager() {
        const [events, setEvents] = useState([]);
        const [currentDate, setCurrentDate] = useState(new Date());
        const [showModal, setShowModal] = useState(false);
        const [selectedEvent, setSelectedEvent] = useState(null);
        const [view, setView] = useState('month');
        const [loading, setLoading] = useState(false);
        const [searchQuery, setSearchQuery] = useState('');
        const [filterDateStart, setFilterDateStart] = useState('');
        const [filterDateEnd, setFilterDateEnd] = useState('');
        const [formData, setFormData] = useState({
          title: '',
          start: '',
          end: '',
          description: '',
          color: '#3788d8'
        });
        const [validationErrors, setValidationErrors] = useState({});

        useEffect(() => {
          loadEvents();
          requestNotificationPermission();
        }, []);

        function loadEvents() {
          setLoading(true);
          getAllEventsFromDB()
            .then(eventsFromDB => {
              setEvents(eventsFromDB);
              setLoading(false);
            })
            .catch(error => {
              console.error('Error loading events:', error);
              setLoading(false);
            });
        }

        function validateForm() {
          const errors = {};
          
          if (!formData.title.trim()) {
            errors.title = 'Judul acara tidak boleh kosong';
          }
          
          if (!formData.start) {
            errors.start = 'Waktu mulai harus diisi';
          }
          
          if (!formData.end) {
            errors.end = 'Waktu selesai harus diisi';
          }
          
          if (formData.start && formData.end) {
            const startDate = new Date(formData.start);
            const endDate = new Date(formData.end);
            
            if (endDate <= startDate) {
              errors.end = 'Waktu selesai harus lebih besar dari waktu mulai';
            }
          }
          
          setValidationErrors(errors);
          return Object.keys(errors).length === 0;
        }

        function handleDateClick(date, hour = 9) {
          const clickedDate = new Date(date);
          const startTime = new Date(clickedDate);
          startTime.setHours(hour, 0, 0, 0);
          const endTime = new Date(startTime);
          endTime.setHours(hour + 1, 0, 0, 0);
          
          setFormData({
            title: '',
            start: formatDate(startTime),
            end: formatDate(endTime),
            description: '',
            color: '#3788d8'
          });
          setSelectedEvent(null);
          setValidationErrors({});
          setShowModal(true);
        }

        function handleEventClick(event, e) {
          if (e) e.stopPropagation();
          setFormData({
            title: event.title,
            start: formatDate(event.start),
            end: formatDate(event.end),
            description: event.description || '',
            color: event.color || '#3788d8'
          });
          setSelectedEvent(event);
          setValidationErrors({});
          setShowModal(true);
        }

        function handleSubmit() {
          if (!validateForm()) return;
          
          setLoading(true);
          
          const eventData = {
            id: selectedEvent ? selectedEvent.id : Date.now().toString(),
            title: formData.title.trim(),
            start: new Date(formData.start).toISOString(),
            end: new Date(formData.end).toISOString(),
            description: formData.description.trim(),
            color: formData.color,
            notified: false,
            createdAt: selectedEvent?.createdAt || new Date().toISOString(),
            updatedAt: new Date().toISOString()
          };

          saveEventToDB(eventData)
            .then(() => loadEvents())
            .then(() => {
              setShowModal(false);
              setFormData({ title: '', start: '', end: '', description: '', color: '#3788d8' });
              setSelectedEvent(null);
              setValidationErrors({});
              showSuccessMessage(selectedEvent ? 'Acara berhasil diperbarui' : 'Acara berhasil ditambahkan');
              setLoading(false);
            })
            .catch(error => {
              console.error('Error saving event:', error);
              alert('Gagal menyimpan acara. Silakan coba lagi.');
              setLoading(false);
            });
        }

        function handleDelete() {
          if (!selectedEvent) return;
          
          const confirmDelete = window.confirm(
            `Apakah Anda yakin ingin menghapus acara "${selectedEvent.title}"?`
          );
          
          if (!confirmDelete) return;
          
          setLoading(true);
          
          deleteEventFromDB(selectedEvent.id)
            .then(() => loadEvents())
            .then(() => {
              setShowModal(false);
              setSelectedEvent(null);
              showSuccessMessage('Acara berhasil dihapus');
              setLoading(false);
            })
            .catch(error => {
              console.error('Error deleting event:', error);
              alert('Gagal menghapus acara. Silakan coba lagi.');
              setLoading(false);
            });
        }

        function handleExport() {
          try {
            const dataStr = JSON.stringify(events, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            const now = new Date();
            link.download = `jadwal_${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}-${String(now.getDate()).padStart(2, '0')}.json`;
            link.click();
            URL.revokeObjectURL(url);
            showSuccessMessage('Data berhasil diekspor');
          } catch (error) {
            console.error('Export error:', error);
            alert('Gagal mengekspor data. Silakan coba lagi.');
          }
        }

        function handleImport(e) {
          const file = e.target.files[0];
          if (!file) return;

          if (!file.name.endsWith('.json')) {
            alert('Format file tidak valid. Harap pilih file JSON.');
            e.target.value = '';
            return;
          }

          const reader = new FileReader();
          reader.onload = (event) => {
            setLoading(true);
            try {
              const importedEvents = JSON.parse(event.target.result);
              
              if (!Array.isArray(importedEvents)) {
                throw new Error('Format data tidak valid.');
              }
              
              const isValidData = importedEvents.every(evt => 
                evt.title && evt.start && evt.end && evt.id
              );
              
              if (!isValidData) {
                throw new Error('Data tidak lengkap.');
              }
              
              const confirmReplace = window.confirm(
                `Ditemukan ${importedEvents.length} acara. Apakah Anda ingin mengganti semua data yang ada?`
              );
              
              let promise = Promise.resolve();
              
              if (confirmReplace) {
                promise = clearAllEventsFromDB();
              }
              
              promise.then(() => {
                const savePromises = importedEvents.map(evt => {
                  return saveEventToDB({
                    ...evt,
                    id: evt.id || Date.now().toString() + Math.random(),
                    notified: false
                  });
                });
                return Promise.all(savePromises);
              })
              .then(() => loadEvents())
              .then(() => {
                showSuccessMessage(`${importedEvents.length} acara berhasil diimpor`);
                setLoading(false);
              })
              .catch(err => {
                console.error('Error during import:', err);
                alert('Gagal mengimpor data.');
                setLoading(false);
              });
              
            } catch (error) {
              console.error('Error importing:', error);
              alert(`Gagal mengimpor data: ${error.message}`);
              setLoading(false);
            }
          };
          
          reader.onerror = () => {
            alert('Gagal membaca file. Silakan coba lagi.');
            setLoading(false);
          };
          
          reader.readAsText(file);
          e.target.value = '';
        }

        function nextMonth() {
          setCurrentDate(new Date(currentDate.getFullYear(), currentDate.getMonth() + 1));
        }

        function prevMonth() {
          setCurrentDate(new Date(currentDate.getFullYear(), currentDate.getMonth() - 1));
        }

        function goToToday() {
          setCurrentDate(new Date());
        }

        function getFilteredEvents() {
          let filtered = [...events];
          
          if (searchQuery.trim()) {
            filtered = filtered.filter(event =>
              event.title.toLowerCase().includes(searchQuery.toLowerCase()) ||
              (event.description && event.description.toLowerCase().includes(searchQuery.toLowerCase()))
            );
          }
          
          if (filterDateStart) {
            filtered = filtered.filter(event => 
              new Date(event.start) >= new Date(filterDateStart)
            );
          }
          
          if (filterDateEnd) {
            const endOfDay = new Date(filterDateEnd);
            endOfDay.setHours(23, 59, 59);
            filtered = filtered.filter(event => 
              new Date(event.start) <= endOfDay
            );
          }
          
          return filtered;
        }

        function getEventsForDate(date) {
          const filteredEvents = getFilteredEvents();
          return filteredEvents.filter(event => {
            const eventStart = new Date(event.start);
            return eventStart.toDateString() === date.toDateString();
          }).sort((a, b) => new Date(a.start) - new Date(b.start));
        }

        function renderMonthView() {
          const year = currentDate.getFullYear();
          const month = currentDate.getMonth();
          const weeks = getWeeksInMonth(year, month);
          
          const monthNames = [
            'Januari', 'Februari', 'Maret', 'April', 'Mei', 'Juni',
            'Juli', 'Agustus', 'September', 'Oktober', 'November', 'Desember'
          ];
          
          const dayNames = ['MIN', 'SEN', 'SEL', 'RAB', 'KAM', 'JUM', 'SAB'];
          
          return (
            <div className="calendar-container">
              <div className="calendar-header">
                <button className="btn btn-outline-primary btn-sm" onClick={prevMonth} disabled={loading}>
                  â€¹ Prev
                </button>
                <h4 className="month-title">{monthNames[month]} {year}</h4>
                <button className="btn btn-outline-primary btn-sm" onClick={nextMonth} disabled={loading}>
                  Next â€º
                </button>
              </div>
              
              <div className="calendar-grid">
                {/* Day headers */}
                <div className="day-headers">
                  {dayNames.map(day => (
                    <div key={day} className="day-header">{day}</div>
                  ))}
                </div>
                
                {/* Weeks */}
                {weeks.map((week, weekIndex) => (
                  <div key={weekIndex} className="calendar-week">
                    {week.map((dayObj, dayIndex) => {
                      const dayEvents = getEventsForDate(dayObj.date);
                      const isToday = new Date().toDateString() === dayObj.date.toDateString();
                      
                      return (
                        <div 
                          key={dayIndex}
                          className={`calendar-day ${!dayObj.isCurrentMonth ? 'other-month' : ''} ${isToday ? 'today' : ''}`}
                          onClick={() => dayObj.isCurrentMonth && handleDateClick(dayObj.date)}
                        >
                          <div className="day-number">{dayObj.date.getDate()}</div>
                          <div className="day-events">
                            {dayEvents.slice(0, 3).map(event => (
                              <div
                                key={event.id}
                                className="event-pill"
                                style={{ backgroundColor: event.color }}
                                onClick={(e) => handleEventClick(event, e)}
                                title={`${event.title} (${formatTime(event.start)} - ${formatTime(event.end)})`}
                              >
                                <span className="event-time">{formatTime(event.start)}</span>
                                <span className="event-title">{event.title}</span>
                              </div>
                            ))}
                            {dayEvents.length > 3 && (
                              <div className="more-events">
                                +{dayEvents.length - 3} lainnya
                              </div>
                            )}
                          </div>
                        </div>
                      );
                    })}
                  </div>
                ))}
              </div>
            </div>
          );
        }

        function renderListView() {
          const filteredEvents = getFilteredEvents();
          const sortedEvents = filteredEvents.sort((a, b) => 
            new Date(a.start) - new Date(b.start)
          );

          if (sortedEvents.length === 0) {
            return (
              <div className="text-center py-5 text-muted">
                <p>{searchQuery || filterDateStart || filterDateEnd 
                  ? 'Tidak ada acara yang sesuai dengan filter' 
                  : 'Belum ada acara yang dijadwalkan'}</p>
              </div>
            );
          }

          return (
            <div className="list-group">
              {sortedEvents.map(event => (
                <div
                  key={event.id}
                  className="list-group-item list-group-item-action cursor-pointer"
                  onClick={() => handleEventClick(event)}
                >
                  <div className="d-flex w-100 justify-content-between align-items-start">
                    <div style={{ flex: 1 }}>
                      <div className="d-flex align-items-center gap-2 mb-2">
                        <div
                          style={{
                            width: '12px',
                            height: '12px',
                            backgroundColor: event.color,
                            borderRadius: '50%'
                          }}
                        ></div>
                        <h5 className="mb-0">{event.title}</h5>
                      </div>
                      <p className="mb-1 text-muted small">
                        {formatDisplayDate(event.start)} - {formatDisplayDate(event.end)}
                      </p>
                      {event.description && (
                        <p className="mb-0 text-secondary">{event.description}</p>
                      )}
                    </div>
                  </div>
                </div>
              ))}
            </div>
          );
        }

        return (
          <div className="app-container">
            <div className="container-fluid py-4" style={{ maxWidth: '1400px' }}>
              <h1 className="text-center mb-4">ðŸ“… Pengelolaan Jadwal</h1>
              
              <div className="controls-section mb-3">
                <div className="row g-2">
                  <div className="col-md-4">
                    <input
                      type="text"
                      className="form-control"
                      placeholder="ðŸ” Cari acara..."
                      value={searchQuery}
                      onChange={(e) => setSearchQuery(e.target.value)}
                    />
                  </div>
                  <div className="col-md-3">
                    <input
                      type="date"
                      className="form-control"
                      value={filterDateStart}
                      onChange={(e) => setFilterDateStart(e.target.value)}
                    />
                  </div>
                  <div className="col-md-3">
                    <input
                      type="date"
                      className="form-control"
                      value={filterDateEnd}
                      onChange={(e) => setFilterDateEnd(e.target.value)}
                    />
                  </div>
                  <div className="col-md-2">
                    <button 
                      className="btn btn-outline-secondary w-100"
                      onClick={() => {
                        setSearchQuery('');
                        setFilterDateStart('');
                        setFilterDateEnd('');
                      }}
                    >
                      Reset
                    </button>
                  </div>
                </div>
              </div>
              
              <div className="d-flex justify-content-center gap-2 mb-3 flex-wrap">
                <button className="btn btn-outline-secondary btn-sm" onClick={goToToday} disabled={loading}>
                  Hari Ini
                </button>
                <button 
                  className={`btn btn-sm ${view === 'month' ? 'btn-primary' : 'btn-outline-primary'}`}
                  onClick={() => setView('month')}
                  disabled={loading}
                >
                  Kalender
                </button>
                <button 
                  className={`btn btn-sm ${view === 'list' ? 'btn-primary' : 'btn-outline-primary'}`}
                  onClick={() => setView('list')}
                  disabled={loading}
                >
                  Daftar
                </button>
                <button className="btn btn-success btn-sm" onClick={handleExport} disabled={loading}>
                  ðŸ“¥ Export
                </button>
                <label className={`btn btn-primary btn-sm ${loading ? 'disabled' : ''}`}>
                  ðŸ“¤ Import
                  <input
                    type="file"
                    accept=".json"
                    onChange={handleImport}
                    style={{ display: 'none' }}
                    disabled={loading}
                  />
                </label>
              </div>

              {loading && (
                <div className="text-center mb-3">
                  <div className="spinner-border text-primary" role="status">
                    <span className="visually-hidden">Loading...</span>
                  </div>
                </div>
              )}
              
              <div className="calendar-wrapper">
                {view === 'month' ? renderMonthView() : renderListView()}
              </div>
            </div>

            {showModal && (
              <div className="modal d-block" style={{ backgroundColor: 'rgba(0,0,0,0.5)' }}>
                <div className="modal-dialog modal-dialog-centered">
                  <div className="modal-content">
                    <div className="modal-header">
                      <h5 className="modal-title">
                        {selectedEvent ? 'Edit Acara' : 'Tambah Acara Baru'}
                      </h5>
                      <button
                        type="button"
                        className="btn-close btn-close-white"
                        onClick={() => {
                          setShowModal(false);
                          setValidationErrors({});
                        }}
                        disabled={loading}
                      ></button>
                    </div>
                    <div className="modal-body">
                      <div className="mb-3">
                        <label className="form-label">Judul Acara *</label>
                        <input
                          type="text"
                          className={`form-control ${validationErrors.title ? 'is-invalid' : ''}`}
                          value={formData.title}
                          onChange={(e) => setFormData({ ...formData, title: e.target.value })}
                          disabled={loading}
                        />
                        {validationErrors.title && (
                          <div className="invalid-feedback">{validationErrors.title}</div>
                        )}
                      </div>
                      <div className="mb-3">
                        <label className="form-label">Waktu Mulai *</label>
                        <input
                          type="datetime-local"
                          className={`form-control ${validationErrors.start ? 'is-invalid' : ''}`}
                          value={formData.start}
                          onChange={(e) => setFormData({ ...formData, start: e.target.value })}
                          disabled={loading}
                        />
                        {validationErrors.start && (
                          <div className="invalid-feedback">{validationErrors.start}</div>
                        )}
                      </div>
                      <div className="mb-3">
                        <label className="form-label">Waktu Selesai *</label>
                        <input
                          type="datetime-local"
                          className={`form-control ${validationErrors.end ? 'is-invalid' : ''}`}
                          value={formData.end}
                          onChange={(e) => setFormData({ ...formData, end: e.target.value })}
                          disabled={loading}
                        />
                        {validationErrors.end && (
                          <div className="invalid-feedback">{validationErrors.end}</div>
                        )}
                      </div>
                      <div className="mb-3">
                        <label className="form-label">Warna</label>
                        <input
                          type="color"
                          className="form-control form-control-color"
                          value={formData.color}
                          onChange={(e) => setFormData({ ...formData, color: e.target.value })}
                          disabled={loading}
                        />
                      </div>
                      <div className="mb-3">
                        <label className="form-label">Deskripsi</label>
                        <textarea
                          className="form-control"
                          rows="3"
                          value={formData.description}
                          onChange={(e) => setFormData({ ...formData, description: e.target.value })}
                          disabled={loading}
                        />
                      </div>
                    </div>
                    <div className="modal-footer">
                      {selectedEvent && (
                        <button
                          type="button"
                          className="btn btn-danger me-auto"
                          onClick={handleDelete}
                          disabled={loading}
                        >
                          {loading ? 'Menghapus...' : 'Hapus'}
                        </button>
                      )}
                      <button
                        type="button"
                        className="btn btn-secondary"
                        onClick={() => {
                          setShowModal(false);
                          setValidationErrors({});
                        }}
                        disabled={loading}
                      >
                        Batal
                      </button>
                      <button 
                        type="button" 
                        className="btn btn-primary"
                        onClick={handleSubmit}
                        disabled={loading}
                      >
                        {loading ? 'Menyimpan...' : 'Simpan'}
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            )}

            <style>{`
              @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
              }
              
              @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
              }
              
              @keyframes fadeIn {
                from { opacity: 0; transform: translateY(20px); }
                to { opacity: 1; transform: translateY(0); }
              }
              
              body {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                min-height: 100vh;
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                margin: 0;
                padding: 0;
              }

              .app-container {
                animation: fadeIn 0.5s ease-in;
              }

              h1 {
                color: white;
                text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
                font-weight: 700;
              }

              .controls-section {
                background: white;
                padding: 1.5rem;
                border-radius: 12px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.1);
              }

              .calendar-wrapper {
                background: white;
                border-radius: 16px;
                padding: 1.5rem;
                box-shadow: 0 10px 30px rgba(0,0,0,0.2);
              }

              .calendar-header {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 1.5rem;
                padding-bottom: 1rem;
                border-bottom: 2px solid #e9ecef;
              }

              .month-title {
                margin: 0;
                font-size: 1.5rem;
                font-weight: 700;
                color: #333;
              }

              .calendar-grid {
                overflow: hidden;
              }

              .day-headers {
                display: grid;
                grid-template-columns: repeat(7, 1fr);
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                border-radius: 8px 8px 0 0;
                margin-bottom: 0;
              }

              .day-header {
                padding: 12px;
                text-align: center;
                font-weight: 700;
                font-size: 0.85rem;
                color: white;
                text-transform: uppercase;
                letter-spacing: 1px;
              }

              .calendar-week {
                display: grid;
                grid-template-columns: repeat(7, 1fr);
                border-left: 1px solid #e9ecef;
                border-right: 1px solid #e9ecef;
              }

              .calendar-week:last-child .calendar-day {
                border-bottom: 1px solid #e9ecef;
              }

              .calendar-day {
                min-height: 120px;
                padding: 8px;
                border-right: 1px solid #e9ecef;
                border-top: 1px solid #e9ecef;
                cursor: pointer;
                transition: background-color 0.2s;
                position: relative;
                overflow: hidden;
              }

              .calendar-day:hover {
                background-color: #f8f9fa;
              }

              .calendar-day.other-month {
                background-color: #f8f9fa;
                opacity: 0.5;
              }

              .calendar-day.other-month .day-number {
                color: #adb5bd;
              }

              .calendar-day.today {
                background-color: #e3f2fd;
              }

              .calendar-day.today .day-number {
                background: #2196F3;
                color: white;
                width: 28px;
                height: 28px;
                border-radius: 50%;
                display: inline-flex;
                align-items: center;
                justify-content: center;
                font-weight: 700;
              }

              .day-number {
                font-size: 0.9rem;
                font-weight: 600;
                color: #333;
                margin-bottom: 4px;
              }

              .day-events {
                display: flex;
                flex-direction: column;
                gap: 2px;
                margin-top: 4px;
              }

              .event-pill {
                padding: 4px 6px;
                border-radius: 4px;
                font-size: 0.75rem;
                color: white;
                cursor: pointer;
                transition: all 0.2s;
                display: flex;
                align-items: center;
                gap: 4px;
                overflow: hidden;
                text-overflow: ellipsis;
                white-space: nowrap;
              }

              .event-pill:hover {
                transform: scale(1.02);
                box-shadow: 0 2px 6px rgba(0,0,0,0.2);
                z-index: 10;
              }

              .event-time {
                font-weight: 600;
                font-size: 0.7rem;
              }

              .event-title {
                flex: 1;
                overflow: hidden;
                text-overflow: ellipsis;
                white-space: nowrap;
              }

              .more-events {
                font-size: 0.7rem;
                color: #6c757d;
                padding: 2px 6px;
                font-weight: 500;
              }

              .btn {
                transition: all 0.3s ease;
                border-radius: 8px;
                font-weight: 500;
                box-shadow: 0 2px 4px rgba(0,0,0,0.1);
              }

              .btn:hover:not(:disabled) {
                transform: translateY(-2px);
                box-shadow: 0 4px 8px rgba(0,0,0,0.2);
              }

              .btn:active {
                transform: translateY(0);
              }
              
              .btn:disabled {
                opacity: 0.6;
                cursor: not-allowed;
              }

              .list-group-item {
                transition: all 0.3s ease;
                border-left: 4px solid transparent;
                margin-bottom: 8px;
                border-radius: 8px !important;
                cursor: pointer;
              }

              .list-group-item:hover {
                border-left-color: #667eea;
                background-color: #f8f9fa;
                transform: translateX(5px);
                box-shadow: 0 4px 8px rgba(0,0,0,0.1);
              }

              .modal-content {
                border-radius: 16px;
                border: none;
                box-shadow: 0 20px 60px rgba(0,0,0,0.3);
                animation: modalSlideIn 0.3s ease;
              }

              @keyframes modalSlideIn {
                from { opacity: 0; transform: scale(0.9) translateY(-20px); }
                to { opacity: 1; transform: scale(1) translateY(0); }
              }

              .modal-header {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                border-radius: 16px 16px 0 0;
                padding: 1.5rem;
              }

              .modal-title {
                font-weight: 600;
                font-size: 1.25rem;
              }

              .modal-body {
                padding: 2rem;
              }

              .modal-footer {
                padding: 1.5rem;
                border-top: 1px solid #e9ecef;
              }

              .form-label {
                font-weight: 600;
                color: #495057;
                margin-bottom: 0.5rem;
              }

              .form-control, .form-control-color {
                border-radius: 8px;
                border: 2px solid #e9ecef;
                transition: all 0.3s ease;
                padding: 0.75rem;
              }

              .form-control:focus, .form-control-color:focus {
                border-color: #667eea;
                box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25);
              }
              
              .form-control.is-invalid {
                border-color: #dc3545;
              }
              
              .form-control.is-invalid:focus {
                box-shadow: 0 0 0 0.2rem rgba(220, 53, 69, 0.25);
              }
              
              .invalid-feedback {
                display: block;
                color: #dc3545;
                font-size: 0.875rem;
                margin-top: 0.25rem;
              }

              textarea.form-control {
                resize: vertical;
              }

              .spinner-border {
                width: 2rem;
                height: 2rem;
              }

              @media (max-width: 768px) {
                .calendar-day {
                  min-height: 80px;
                  padding: 4px;
                }

                .day-number {
                  font-size: 0.8rem;
                }

                .event-pill {
                  font-size: 0.65rem;
                  padding: 2px 4px;
                }

                .day-header {
                  font-size: 0.7rem;
                  padding: 8px 4px;
                }

                h1 {
                  font-size: 1.5rem;
                }

                .month-title {
                  font-size: 1.2rem;
                }
              }

              ::-webkit-scrollbar {
                width: 8px;
                height: 8px;
              }

              ::-webkit-scrollbar-track {
                background: #f1f1f1;
                border-radius: 10px;
              }

              ::-webkit-scrollbar-thumb {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                border-radius: 10px;
              }

              ::-webkit-scrollbar-thumb:hover {
                background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
              }
            `}</style>
          </div>
        );
      }

      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<ScheduleManager />);
    </script>
  </body>
</html>